# **オンライン原稿用紙 for GIGA School 📝**

Google Apps Script (GAS) と Googleスプレッドシートで動作する、ブラウザ完結型の原稿用紙Webアプリケーションです。

GIGAスクール構想下の公立小学校での利用を想定し、Chromebook等のタブレット端末で快適に動作するように設計されています。

## **🌟 特徴**

* **リアルタイム縦書きプレビュー**: 左側の入力エリアに文字を打つと、右側の原稿用紙に縦書きで即座に反映されます。  
* **禁則処理対応**: 句読点が行頭に来ないよう、自動でぶら下げ処理や追い出し処理を行います。  
* **学年別設定**: 高学年用（20字×20行）と低学年用（15字×16行）の切り替えが可能です。  
* **堅牢なデータ保存**:  
  * **サーバー保存**: Googleスプレッドシートをデータベースとして利用。排他制御（ロック処理）により、40人学級での一斉保存でもデータ競合を防ぎます。  
  * **自動保存**: ブラウザのローカルストレージを利用し、誤ってタブを閉じても直前の状態から復元できます。  
* **印刷・PDF化**: ブラウザの印刷機能（Ctrl+P）を利用して、A4横向きの綺麗な原稿用紙レイアウトで出力できます。  
* **先生に優しい管理**: データは全てスプレッドシートに蓄積されるため、一覧性があり管理が容易です。

## **🛠️ 技術スタック**

* **Backend**: Google Apps Script (GAS)  
* **Database**: Google Sheets  
* **Frontend**: HTML5, CSS3, JavaScript  
* **Framework/Library**:  
  * Bootstrap 5 (UIコンポーネント)  
  * Bootstrap Icons (アイコン)  
  * SweetAlert2 (ダイアログ表示)  
  * Google Fonts (Zen丸ゴシック, Zenオールド明朝)

## **🚀 導入手順 (インストール)**

このアプリはGoogleアカウントがあれば無料で構築できます。サーバーの契約は不要です。

### **1\. スプレッドシートの準備**

1. 新規のGoogleスプレッドシートを作成します。  
2. シート名を 作文データ に変更してください。  
3. 1行目にヘッダーを作成する必要はありませんが、データは以下の列仕様で保存されます（2行目以降にデータが入ります）。  
   * A列: ID  
   * B列: 題名  
   * C列: 学年・クラス  
   * D列: 氏名  
   * E列: 本文  
   * F列: 作成日時  
   * G列: 更新日時  
   * H列: 削除日時（論理削除用）

### **2\. スクリプトの作成**

1. スプレッドシートのメニューから 拡張機能 \> Apps Script を開きます。  
2. エディタが開いたら、以下のファイルを作成・コピーしてください。  
   * **コード.gs (Code.gs)**: サーバーサイドのコードを貼り付けます。  
   * **index.html**: HTMLファイルを追加し、クライアントサイドのコードを貼り付けます。

### **3\. デプロイ**

1. 画面右上の デプロイ \> 新しいデプロイ をクリックします。  
2. 「種類の選択」で ウェブアプリ を選択します。  
3. 以下の設定を行います：  
   * **説明**: （任意）  
   * **次のユーザーとして実行**: 自分 (※重要: スプレッドシートへのアクセス権を持つアカウントで実行するため)  
   * **アクセスできるユーザー**: Googleアカウントを持つ全員 または 全員 (学校のポリシーに合わせてください)  
4. デプロイ をクリックし、表示された **ウェブアプリのURL** を児童・生徒に共有してください。

## **📖 使い方**

### **児童・生徒**

1. 共有されたURLにアクセスします。  
2. 「題名」「学年」「氏名」を入力し、本文を書きます。  
3. **保存する**: スプレッドシートにデータを保存します。  
4. **読み込み**: 過去に保存した自分の作文を呼び出します（検索機能あり）。  
5. **印刷する**: 印刷プレビュー画面が開き、PDF保存や印刷が可能です。

### **先生（管理者）**

* 児童が保存した作文は、スプレッドシートの 作文データ シートに自動的に蓄積されます。  
* 添削を行いたい場合は、スプレッドシート上で確認するか、アプリ上で読み込んで印刷してください。

## **⚠️ 注意事項**

* **初期回線負荷**: 授業開始時に40人が一斉にアクセスすると、外部ライブラリ（Bootstrap等）の読み込みに時間がかかる場合があります。  
* **排他制御**: 保存時に「混み合っています」と表示された場合は、数秒待ってから再度保存ボタンを押すよう指導してください。

## **📜 ライセンス**

This project is licensed under the MIT License.
